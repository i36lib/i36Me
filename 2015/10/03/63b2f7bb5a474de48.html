<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
<title>MySQL集群实验 - 阿北</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="2015年07月13日，官方发布了MySQL Cluster 7.4.7版本，趁着十一有空，根据官方文档的指引，基于VBox和Fedora Server，从0到1搭建MySQL Cluster集群的环境，记录搭建过程。">
<meta name="keywords" content="数据库,MySQL,集群">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL集群实验">
<meta property="og:url" content="https://i36.Me/2015/10/03/63b2f7bb5a474de48.html">
<meta property="og:site_name" content="阿北">
<meta property="og:description" content="2015年07月13日，官方发布了MySQL Cluster 7.4.7版本，趁着十一有空，根据官方文档的指引，基于VBox和Fedora Server，从0到1搭建MySQL Cluster集群的环境，记录搭建过程。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://i36.me/i/EsFikdvt4G2OcXb.png">
<meta property="og:updated_time" content="2015-10-02T16:00:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL集群实验">
<meta name="twitter:description" content="2015年07月13日，官方发布了MySQL Cluster 7.4.7版本，趁着十一有空，根据官方文档的指引，基于VBox和Fedora Server，从0到1搭建MySQL Cluster集群的环境，记录搭建过程。">
<meta name="twitter:image" content="https://i36.me/i/EsFikdvt4G2OcXb.png">





<link rel="icon" href="/images/logo.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-24320647-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-24320647-1');
</script>


    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    


<link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body class="is-2-column">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="MySQL集群实验" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">主页</a>
                
                <a class="navbar-item" href="/categories">分类</a>
                
                <a class="navbar-item" href="/archives">归档</a>
                
                <a class="navbar-item" href="/about">关于</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="http://github.com/i36lib">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main"><div class="card">
    <!-- 
    <div class="card-image">
        <span  class="image is-7by1">
            <img class="thumbnail" src="/i/EsFikdvt4G2OcXb.png" alt="MySQL集群实验">
        </span>
    </div>
     -->
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                MySQL集群实验
            
        </h1>
        
            <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto" style="margin-bottom: 0;">
            <div class="level-left">
                <i class="fas fa-calendar">&nbsp</i>
                <time class="level-item has-text-grey" datetime="2015-10-02T16:00:00.000Z">2015-10-03</time>
                
                
                <i class="fas fa-book">&nbsp</i>
                <span class="level-item has-text-grey">
                    
                    
                    24 分钟 读完 (大约 3619 个字)
                </span>
                
            </div>
        </div>
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                
                    <i class="fas fa-folder-open">&nbsp</i>
                    <div class="level-item">
                    <a class="has-link-grey -link" href="/categories/MySQL/">MySQL</a>
                    </div>
                
                
                    <i class="fas fa-tags">&nbsp</i>
                    <div class="level-item">
                    <a class="has-link-grey -link" href="/tags/MySQL/">MySQL</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/tags/数据库/">数据库</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/tags/集群/">集群</a>
                    </div>
                
            </div>
        </div>
        
        <div class="content">
             
            <p>2015年07月13日，官方发布了MySQL Cluster 7.4.7版本，趁着十一有空，根据官方文档的指引，基于VBox和Fedora Server，从0到1搭建MySQL Cluster集群的环境，记录搭建过程。</p>
<a id="more"></a>

<h2 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h2><ul>
<li><strong>服务器</strong>：<a href="http://mirrors.ustc.edu.cn/fedora/linux/releases/22/Server/x86_64/iso/Fedora-Server-DVD-x86_64-22.iso" target="_blank" rel="noopener">Fedora Server 22-x86_64</a> Under VBox</li>
<li><strong>MySQL</strong>：<a href="http://mirrors.sohu.com/mysql/MySQL-Cluster-7.4/mysql-cluster-gpl-7.4.7-linux-glibc2.5-x86_64.tar.gz" target="_blank" rel="noopener">MySQL Cluster(GPL) 7.4.7 linux glibc2.5 x86_64</a></li>
<li><strong>具体版本</strong>：MySQL Cluster Community Server(GPL) 5.6.25-ndb-7.4.7-cluster-gpl </li>
<li><strong>配置信息</strong>：<ul>
<li><strong>Management</strong>  ： <code>192.168.1.80</code>  mgmt.dbsvr.com，用以管理集群</li>
<li><strong>Storage Node</strong>： <code>192.168.1.81</code>  ndb01.dbsvr.com，用作数据存储</li>
<li><strong>Storage Node</strong>： <code>192.168.1.82</code>  ndb02.dbsvr.com，用作数据存储</li>
<li><strong>Storage Node</strong>： <code>192.168.1.83</code>  ndb03.dbsvr.com，用作数据存储</li>
<li><strong>SQL Node</strong>    ： <code>192.168.1.84</code>  sql01.dbsvr.com，用以执行SQL</li>
<li><strong>SQL Node</strong>    ： <code>192.168.1.85</code>  sql02.dbsvr.com，用以执行SQL</li>
</ul>
</li>
<li><strong>Hosts配置</strong>：</li>
</ul>
<p>各个MySQL Cluster节点的hosts(/etc/hosts)统一配置为：</p>
<blockquote>
<p>192.168.1.80 mgmt.dbsvr.com # NDB Management Server<br>192.168.1.81 ndb01.dbsvr.com # Data Node 01<br>192.168.1.82 ndb02.dbsvr.com # Data Node 02<br>192.168.1.83 ndb03.dbsvr.com # Data Node 03<br>192.168.1.84 sql01.dbsvr.com # SQL Node 01<br>192.168.1.85 sql02.dbsvr.com # SQL Node 02</p>
</blockquote>
<h2 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h2><p>由于实验环境在虚拟机中进行，虚拟机网络设置要使用<code>桥接</code>方式。可先安装好一个结点，然后再克隆虚拟机，修改Mac和IP地址，作为其他结点。如果全部在实体机上安装，可安装完成一台，然后其他机器再按照这台的安装经验来安装，避免出现其他问题。</p>
<p>安装好Fedora之后安装Vim、配置<a href="https://lug.ustc.edu.cn/wiki/mirrors/help/fedora" target="_blank" rel="noopener">中科大镜像源</a>，安装dnf取代yum，关闭防火墙，修改hosts(/etc/hosts)和hostname(/etc/hostname，修改后将在命令行中显示为<code>[admin@hostname]$</code>)。在<code>/etc/sysconfig/network-scripts</code>编辑<code>ifcfg-enp0s3</code>，将ip地址由dhcp动态分配改为static静态分配(注释部分为原内容，这里只列出修改和增加的部分内容)：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> <span class="hljs-built_in">cd</span> /etc/sysconfig/network-scripts</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo vim ifcfg-enp0s3</span></span><br><span class="line">HWADDR="08:00:27:6E:39:CF"</span><br><span class="line"><span class="hljs-meta">#</span><span class="hljs-bash">BOOTPROTO=<span class="hljs-string">"dhcp"</span></span></span><br><span class="line">BOOTPROTO="static"</span><br><span class="line"><span class="hljs-meta">#</span><span class="hljs-bash">add by admin</span></span><br><span class="line">NM_CONTROLLED="yes"</span><br><span class="line">IPADDR="192.168.1.80"</span><br><span class="line">NETMASK="255.255.255.0"</span><br><span class="line">GATEWAY="192.168.1.1"</span><br><span class="line">DNS1=172.16.1.3</span><br></pre></td></tr></table></figure>

<p>这里使用二进制安装方式，MySQL Cluster的安装与普通MySQL Server的安装并没有什么区别，区别只在于Cluster多了一些不一样的配置。</p>
<p>已事先将<code>mysql-cluster-gpl-7.4.7-linux-glibc2.5-x86_64.tar.gz</code>下载到<code>~/</code>目录下(使用虚拟机的情况下可以在服务内<a href="/Linux/7607fe3b0f8b4815aab1b5679c9446b3.html">使用VSFTP搭建FTP服务器</a>传文件)，安装过程参考解压后<code>mysql-cluster-gpl-7.4.7-linux-glibc2.5-x86_64</code>文件夹下的<code>INSTALL-BINARY</code>文件。这里是Fedora Server 22，为了避免后面的<code>scripts/mysql_install_db --user=mysql</code>执行出错，先安装<code>perl</code>：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">$</span><span class="hljs-bash"> sudo dnf install -y perl-Module-Install.noarch</span></span><br></pre></td></tr></table></figure>

<p>然后创建用户和组，解压，更改权限，开始安装MySQL Cluster(在一个具有Administrator权限的用户admin下)：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo groupadd mysql</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo useradd -r -g mysql mysql</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> <span class="hljs-built_in">cd</span> /usr/<span class="hljs-built_in">local</span></span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo tar xzvf ~/mysql-cluster-gpl-7.4.7-linux-glibc2.5-x86_64.tar.gz</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo ln -s /usr/<span class="hljs-built_in">local</span> mysql-cluster-gpl-7.4.7-linux-glibc2.5-x86_64 mysql</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> <span class="hljs-built_in">cd</span> mysql</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo chown -R mysql .</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo chgrp -R mysql .</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo scripts/mysql_install_db --user=mysql</span></span><br></pre></td></tr></table></figure>

<p>如果mysql_install_db成功则会提示：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">New default config file was created as ./my.cnf and</span><br><span class="line">will be used by default by the server when you start it.</span><br><span class="line">You may edit this file to change server settings</span><br></pre></td></tr></table></figure>

<p>然后将当前目录(/usr/local/mysql)文件权限设置给root，但data即数据库文件目录设置给mysql：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> chown -R root .</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> chown -R mysql data</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo bin/mysqld_safe --user=mysql &amp;</span></span><br></pre></td></tr></table></figure>

<p>检验是否安装成功，进入support-files，启动mysql server：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo ./mysql.server start</span></span><br><span class="line">Starting MySQL SUCCESS!</span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> <span class="hljs-built_in">cd</span> ../bin</span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> ./mysql</span></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 2</span><br><span class="line">Server version: 5.6.25-ndb-7.4.7-cluster-gpl MySQL Cluster Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> show databases;</span></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| test               |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span></span><br></pre></td></tr></table></figure>

<p>MySQL本地服务器安装成功，这就说明安装成功了，但是root账户还没设置密码，需要为root账户设置密码：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> <span class="hljs-built_in">pwd</span></span></span><br><span class="line">/usr/local/mysql/bin</span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> ./mysqladmin -u root password <span class="hljs-string">"123456"</span></span></span><br><span class="line">Warning: Using a password on the command line interface can be insecure.</span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span></span><br></pre></td></tr></table></figure>

<p>以上是第一次设置root密码的时候，在命令行下设置，提示通过命令行接口设置密码不安全，不管它。另一个方法是进入mysql设置，这样会比较安全：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> <span class="hljs-built_in">pwd</span></span></span><br><span class="line">/usr/local/mysql/bin</span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> ./mysql -u root</span></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 2</span><br><span class="line">Server version: 5.6.25-ndb-7.4.7-cluster-gpl MySQL Cluster Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> SET PASSWORD FOR <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span>=PASSWORD(<span class="hljs-string">'123456'</span>);</span></span><br><span class="line">1 rows in set (0.00 sec)</span><br><span class="line"><span class="hljs-meta">mysql&gt;</span></span><br></pre></td></tr></table></figure>

<p>为了便于进入mysql，在用户配置文件中加入别名设置，这样就可以直接通过在任意地方键入mysql来进入mysql：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> <span class="hljs-built_in">cd</span></span></span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> ls -a</span></span><br><span class="line">.              .bash_profile</span><br><span class="line">..             .bashrc</span><br><span class="line">.bash_history  .mysql_history</span><br><span class="line">.bash_logout   mysql-cluster-gpl-7.4.7-linux-glibc2.5-x86_64.tar.gz</span><br><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> vim ./.bashrc</span></span><br></pre></td></tr></table></figure>

<p>然后在<code>.bashrc</code>中加入这一行<code>alias mysql=/usr/local/bin/mysql</code>，保存退出。</p>
<h2 id="节点克隆"><a href="#节点克隆" class="headerlink" title="节点克隆"></a>节点克隆</h2><p>由于各个MySQL Cluster结点是装在虚拟机中，所以直接使用VBox的虚拟机克隆操作就可以实现，克隆时要选择<code>重新初始化网卡mac地址</code>，以及选择<code>Full Clone</code>即完全克隆，这样会实际拷贝一份虚拟机。由于克隆后系统只是直接复制，所以需要根据VBox虚拟机网卡设置中新分配的MAC地址来修改克隆后的结点的MAC地址和IP地址，路径在：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">[admin@mgmt]$</span><span class="hljs-bash"> sudo vim /etc/sysconfig/network-scripts/ifcfg-enp0s3</span></span><br><span class="line">HWADDR="08:00:27:2F:CF:AE"</span><br><span class="line">IPADDR="192.168.1.81"</span><br></pre></td></tr></table></figure>

<p>通过如下命令来在工作站(我的是Mac，工作站的hosts也同一开始说的各个MySQL Cluster结点的hosts设置)中启动虚拟机结点(即MySQL集群服务器)，以及用ssh登陆(虚拟机网卡设置为桥接)：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Fury:~ Fury$ VBoxManage startvm mgmt.dbsvr.com -type vrdp</span><br><span class="line">Waiting for VM "mgmt.dbsvr.com" to power on...</span><br><span class="line">VM "mgmt.dbsvr.com" has been successfully started.</span><br><span class="line">Fury:~ Fury$ ssh -p 22 admin@mgmt.dbsvr.com</span><br></pre></td></tr></table></figure>

<p>上面的startvm后的mgmt.dbsvr.com是虚拟机的名称，我这里恰好设置成了同结点的host domain，<code>vrdp</code>全称为<code>V</code>irtual box <code>R</code>emote <code>D</code>esktop <code>P</code>rotocol。<br><img src="/i/EsFikdvt4G2OcXb.png" alt="克隆集群服务器"></p>
<h2 id="结点配置"><a href="#结点配置" class="headerlink" title="结点配置"></a>结点配置</h2><p>在各个节点配置好之后首先要启动Management管理结点，然后启动Data Node数据节点和SQL Node查询结点(API结点)。</p>
<h3 id="管理节点-MGM-配置"><a href="#管理节点-MGM-配置" class="headerlink" title="管理节点(MGM)配置"></a>管理节点(MGM)配置</h3><p>管理节点即集群的中心，该节点需要记录其下有哪些数据节点和SQL节点，该节点的配置文件有两个，一个是my.cnf本身，一个是config.ini，其中config.ini需要包含入my.cnf当中。管理节点的my.cnf配置文件如下：</p>
<figure class="highlight ini hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># my.cnf</span></span><br><span class="line"><span class="hljs-comment"># # example additions to my.cnf for MySQL Cluster (valid in MySQL 5.6)</span></span><br><span class="line"><span class="hljs-comment">#</span></span><br><span class="line"><span class="hljs-comment"># # provide connection string for management server host (default port: 1186)</span></span><br><span class="line"><span class="hljs-section">[ndb_mgm]</span></span><br><span class="line"><span class="hljs-attr">connect-string</span>=mgmt.dbsvr.com</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">#</span></span><br><span class="line"><span class="hljs-comment"># # provide location of cluster configuration file</span></span><br><span class="line"><span class="hljs-section">[ndb_mgmd]</span></span><br><span class="line"><span class="hljs-attr">config-file</span>=/etc/mysql/config.ini</span><br></pre></td></tr></table></figure>

<p>在<code>[ndb_mgm]</code>部分通过<code>connect-string</code>指明管理节点的host，这里由于配置了hosts，所以直接写域名，也可以直接写ip地址，管理节点默认的链接端口为<code>1186</code>。在<code>[ndb_mgmd]</code>部分通过<code>config-file</code>来指明Cluster的全局配置文件，里面指明了该集群包括哪些数据节点和SQL节点。这里新建并放置<code>config.ini</code>文件于<code>/etc/mysql/</code>下，该全局配置文件的内容如下(需要自己创建<code>/var/lib/mysql-cluster</code>和<code>/usr/local/mysql/mysql-cluster</code>目录，关于<code>NoOfReplicas</code>请参考官方说明：<a href="http://dev.mysql.com/doc/mysql-cluster-excerpt/5.1/en/mysql-cluster-ndbd-definition.html#ndbparam-ndbd-noofreplicas" target="_blank" rel="noopener">NoOfReplicas</a>)：</p>
<figure class="highlight ini hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># file "config.ini" - 2 data nodes and 2 SQL nodes</span></span><br><span class="line"><span class="hljs-comment"># This file is placed in the startup directory of ndb_mgmd (the</span></span><br><span class="line"><span class="hljs-comment"># management server)</span></span><br><span class="line"><span class="hljs-comment"># The first MySQL Server can be started from any host. The second</span></span><br><span class="line"><span class="hljs-comment"># can be started only on the host mysqld_5.mysql.com</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-section">[ndbd default]</span></span><br><span class="line"><span class="hljs-attr">NoOfReplicas</span>= <span class="hljs-number">1</span></span><br><span class="line"><span class="hljs-attr">DataDir</span>=/usr/local/mysql/mysql-cluster</span><br><span class="line"></span><br><span class="line"><span class="hljs-section">[ndb_mgmd]</span></span><br><span class="line"><span class="hljs-attr">Hostname</span>= mgmt.dbsvr.com</span><br><span class="line"><span class="hljs-attr">DataDir</span>=/var/lib/mysql-cluster</span><br><span class="line"></span><br><span class="line"><span class="hljs-section">[ndbd]</span></span><br><span class="line"><span class="hljs-attr">HostName</span>=ndb01.dbsvr.com</span><br><span class="line"><span class="hljs-section">[ndbd]</span></span><br><span class="line"><span class="hljs-attr">HostName</span>=ndb02.dbsvr.com</span><br><span class="line"><span class="hljs-section">[ndbd]</span></span><br><span class="line"><span class="hljs-attr">HostName</span>=ndb03.dbsvr.com</span><br><span class="line"></span><br><span class="line"><span class="hljs-section">[mysqld]</span></span><br><span class="line"><span class="hljs-attr">HostName</span>=sql01.dbsvr.com</span><br><span class="line"><span class="hljs-section">[mysqld]</span></span><br><span class="line"><span class="hljs-attr">HostName</span>=sql02.dbsvr.com</span><br></pre></td></tr></table></figure>

<p>由于mysql会寻找<code>/etc/my.cnf</code>来读取配置文件，所以可以通过如下命令来为<code>my.cnf</code>创建一个链接放到<code>/etc/</code>下：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[admin@mgmt mysql]$ pwd</span><br><span class="line">/usr/local/mysql</span><br><span class="line">[admin@mgmt mysql]$ sudo ln -s /usr/local/mysql/my.cnf /etc/my.cnf</span><br></pre></td></tr></table></figure>

<p>通过在<code>/usr/local/mysql/bin/</code>下使用<code>ndb_mgmd</code>(关于ndb_mgmd子程序的参数和作用参见命令<code>$ ndb_mgmd --help</code>)来启动管理节点：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[admin@mgmt mysql]$ pwd</span><br><span class="line">/usr/local/mysql</span><br><span class="line">[admin@mgmt mysql]$ sudo bin/ndb_mgmd</span><br><span class="line">[sudo] password for admin: </span><br><span class="line">MySQL Cluster Management Server mysql-5.6.25 ndb-7.4.7</span><br><span class="line">[admin@mgmt mysql]$</span><br></pre></td></tr></table></figure>

<p>通过如下命令来查看节点的连接情况(关于ndb_mgm子程序的参数和作用参见命令<code>ndb_mgm --help</code>)：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[admin@mgmt mysql]$ bin/ndb_mgm -e show</span><br><span class="line">Connected to Management Server at: mgmt.dbsvr.com:1186</span><br><span class="line">Cluster Configuration</span><br><span class="line">---------------------</span><br><span class="line">[ndbd(NDB)]	3 node(s)</span><br><span class="line">id=2 (not connected, accepting connect from ndb01.dbsvr.com)</span><br><span class="line">id=3 (not connected, accepting connect from ndb02.dbsvr.com)</span><br><span class="line">id=4 (not connected, accepting connect from ndb03.dbsvr.com)</span><br><span class="line"></span><br><span class="line">[ndb_mgmd(MGM)]	1 node(s)</span><br><span class="line">id=1	@192.168.1.80  (mysql-5.6.25 ndb-7.4.7)</span><br><span class="line"></span><br><span class="line">[mysqld(API)]	2 node(s)</span><br><span class="line">id=5 (not connected, accepting connect from sql01.dbsvr.com)</span><br><span class="line">id=6 (not connected, accepting connect from sql02.dbsvr.com)</span><br><span class="line"></span><br><span class="line">[admin@mgmt mysql]$</span><br></pre></td></tr></table></figure>

<p>可以看到管理节点已经启动，地址为<code>192.168.1.80</code>，而三个数据节点和两个SQL节点均未连接过来。</p>
<h3 id="数据节点-NDB-配置"><a href="#数据节点-NDB-配置" class="headerlink" title="数据节点(NDB)配置"></a>数据节点(NDB)配置</h3><p>数据节点的配置相对管理节点要简单一些，它不需要config.ini，只需要在my.cnf中声明其本身为数据节点同时指定管理结点即可。同样地，为my.cnf创建一个链接放到/etc/下：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[admin@mgmt mysql]$ pwd</span><br><span class="line">/usr/local/mysql</span><br><span class="line">[admin@mgmt mysql]$ sudo ln -s /usr/local/mysql/my.cnf /etc/my.cnf</span><br></pre></td></tr></table></figure>

<p>在管理节点的config.ini中的[ndbd default]部分，我们通过DataDir来指定了数据节点的数据库文件存放位置为/usr/local/mysql/mysql-cluster，所以这里需要创建<code>/usr/local/mysql/mysql-cluster</code>目录。如下列出了my.cnf配置文件的内容：</p>
<figure class="highlight ini hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># For advice on how to change settings please see</span></span><br><span class="line"><span class="hljs-comment"># http://dev.mysql.com/doc/refman/5.6/en/server-configuration-defaults.html</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-section">[mysqld]</span></span><br><span class="line">ndbcluster</span><br><span class="line"><span class="hljs-attr">ndb-connectstring</span>=mgmt.dbsvr.com</span><br><span class="line"></span><br><span class="line"><span class="hljs-section">[mysql_cluster]</span></span><br><span class="line"><span class="hljs-attr">ndb-connectstring</span>=mgmt.dbsvr.com</span><br></pre></td></tr></table></figure>

<p>在[mysqld]部分使用ndbcluster来指明当前是数据节点，然后指明管理节点的地址，另外还需要[mysql_cluster]部分同时在该部分指明管理节点的地址。</p>
<p>使用ndbd子程序来启动数据节点，关于ndbd的参数请参考命令<code>$ ndbd --help</code>，使用如下命令来启动该数据节点：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[admin@ndb01 bin]$ pwd</span><br><span class="line">/usr/local/mysql/bin</span><br><span class="line">[admin@ndb01 bin]$ sudo ./ndbd      --initial</span><br><span class="line">2015-10-03 11:15:52 [ndbd] INFO     -- Angel connected to 'mgmt.dbsvr.com:1186'</span><br><span class="line">2015-10-03 11:15:52 [ndbd] INFO     -- Angel allocated nodeid: 2</span><br><span class="line">[admin@ndb01 bin]$</span><br></pre></td></tr></table></figure>

<p>这说明该节点已经启动成功并且连接到了管理节点，它分配到的节点ID为2。回到管理节点进行查看：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[admin@mgmt mysql]$ bin/ndb_mgm -e show</span><br><span class="line">Connected to Management Server at: mgmt.dbsvr.com:1186</span><br><span class="line">Cluster Configuration</span><br><span class="line">---------------------</span><br><span class="line">[ndbd(NDB)]	3 node(s)</span><br><span class="line">id=2	@192.168.1.81  (mysql-5.6.25 ndb-7.4.7, starting, Nodegroup: 0)</span><br><span class="line">id=3 (not connected, accepting connect from ndb02.dbsvr.com)</span><br><span class="line">id=4 (not connected, accepting connect from ndb03.dbsvr.com)</span><br><span class="line"></span><br><span class="line">[ndb_mgmd(MGM)]	1 node(s)</span><br><span class="line">id=1	@192.168.1.80  (mysql-5.6.25 ndb-7.4.7)</span><br><span class="line"></span><br><span class="line">[mysqld(API)]	2 node(s)</span><br><span class="line">id=5 (not connected, accepting connect from sql01.dbsvr.com)</span><br><span class="line">id=6 (not connected, accepting connect from sql02.dbsvr.com)</span><br><span class="line"></span><br><span class="line">[admin@mgmt mysql]$</span><br></pre></td></tr></table></figure>

<p>可以发现这个数据节点已经连接上了。使用同样方式配置和启动其他两个数据节点。</p>
<h3 id="SQL节点-API-配置"><a href="#SQL节点-API-配置" class="headerlink" title="SQL节点(API)配置"></a>SQL节点(API)配置</h3><p>SQL节点的配置文件内容是同数据节点的是一样的，但是它由于不存储数据而只做查询，所以不需要创建/usr/local/mysql/mysql-cluster目录，只需要在安装好之后在my.cnf中同数据节点一样加入配置内容即可：</p>
<figure class="highlight ini hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-section">[mysqld]</span></span><br><span class="line">ndbcluster</span><br><span class="line"><span class="hljs-attr">ndb-connectstring</span>=mgmt.dbsvr.com</span><br><span class="line"></span><br><span class="line"><span class="hljs-section">[mysql_cluster]</span></span><br><span class="line"><span class="hljs-attr">ndb-connectstring</span>=mgmt.dbsvr.com</span><br></pre></td></tr></table></figure>

<p>SQL节点的启动是启动MySQL Server，即：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[admin@sql01 support-files]$ pwd</span><br><span class="line">/usr/local/mysql/support-files</span><br><span class="line">[admin@sql01 support-files]$ sudo ./mysql.server start</span><br><span class="line">Starting MySQL.. SUCCESS! </span><br><span class="line">[admin@sql01 support-files]$</span><br></pre></td></tr></table></figure>

<p>以同样方式配置和启动另外一个SQL节点。</p>
<h3 id="集群状态检查"><a href="#集群状态检查" class="headerlink" title="集群状态检查"></a>集群状态检查</h3><p>回到管理节点执行命令查看各个节点的连接情况：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[admin@mgmt mysql]$ bin/ndb_mgm -e show</span><br><span class="line">Connected to Management Server at: mgmt.dbsvr.com:1186</span><br><span class="line">Cluster Configuration</span><br><span class="line">---------------------</span><br><span class="line">[ndbd(NDB)]	3 node(s)</span><br><span class="line">id=2	@192.168.1.81  (mysql-5.6.25 ndb-7.4.7, Nodegroup: 0, *)</span><br><span class="line">id=3	@192.168.1.82  (mysql-5.6.25 ndb-7.4.7, Nodegroup: 1)</span><br><span class="line">id=4	@192.168.1.83  (mysql-5.6.25 ndb-7.4.7, Nodegroup: 2)</span><br><span class="line"></span><br><span class="line">[ndb_mgmd(MGM)]	1 node(s)</span><br><span class="line">id=1	@192.168.1.80  (mysql-5.6.25 ndb-7.4.7)</span><br><span class="line"></span><br><span class="line">[mysqld(API)]	2 node(s)</span><br><span class="line">id=5	@192.168.1.84  (mysql-5.6.25 ndb-7.4.7)</span><br><span class="line">id=6	@192.168.1.85  (mysql-5.6.25 ndb-7.4.7)</span><br><span class="line"></span><br><span class="line">[admin@mgmt mysql]$</span><br></pre></td></tr></table></figure>

<p>可以发现所有的三个数据节点和两个SQL节点都已经连接上来了。接着就可以进行测试。</p>
<h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ol>
<li><a href="http://dev.mysql.com/doc/refman/5.6/en/mysql-cluster-configuration.html" target="_blank" rel="noopener">Configuration of MySQL Cluster</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.6/en/mysql-cluster-config-file.html" target="_blank" rel="noopener">MySQL Cluster Configuration Files</a></li>
</ol>
<h2 id="集群测试"><a href="#集群测试" class="headerlink" title="集群测试"></a>集群测试</h2><p>使用集群需要指定引擎为<code>NDBCLUSTER</code>，这样才能使用集群功能，否则使用的只是节点的本地MySQL服务器。</p>
<h3 id="执行测试"><a href="#执行测试" class="headerlink" title="执行测试"></a>执行测试</h3><p>进入<code>sql01</code>这个SQL节点，在test数据库中创建一个表并插入数据，然后到另外一个查询节点看看情况。分别在sql01和sql02中进入test数据库并查看表，发现为空：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[admin@sql01 ~]$ mysql</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.6.25-ndb-7.4.7-cluster-gpl MySQL Cluster Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> show databases;</span></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| test               |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> use <span class="hljs-built_in">test</span>;</span></span><br><span class="line">Database changed</span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> show tables;</span></span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span></span><br></pre></td></tr></table></figure>

<p>在sql01结点中创建一个表并插入一条数据，注意一定要指定engine为ndbcluster：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> create table cluster_test(id int) engine=ndbcluster;</span></span><br><span class="line">Query OK, 0 rows affected (0.23 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> insert into cluster_test(id) values(1010);</span></span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> select * from cluster_test;</span></span><br><span class="line">+------+</span><br><span class="line">| id   |</span><br><span class="line">+------+</span><br><span class="line">| 1010 |</span><br><span class="line">+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后切换到sql02节点，重新show tables;看看情况：</p>
<figure class="highlight shell hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> show tables;</span></span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> show tables;</span></span><br><span class="line">+----------------+</span><br><span class="line">| Tables_in_test |</span><br><span class="line">+----------------+</span><br><span class="line">| cluster_test   |</span><br><span class="line">+----------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span><span class="hljs-bash"> select * from cluster_test;</span></span><br><span class="line">+------+</span><br><span class="line">| id   |</span><br><span class="line">+------+</span><br><span class="line">| 1010 |</span><br><span class="line">+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">mysql&gt;</span></span><br></pre></td></tr></table></figure>

<p>发现在sql02节点当中已经可以看到在sql01当中创建的表了，查询也取出了数据。这说明该集群的基本配置是已经成功了。</p>
<h3 id="参考文档-1"><a href="#参考文档-1" class="headerlink" title="参考文档"></a>参考文档</h3><ol>
<li><a href="http://dev.mysql.com/doc/refman/5.6/en/mysql-cluster-quick.html" target="_blank" rel="noopener">Quick Test Setup of MySQL Cluster</a></li>
</ol>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/MySQL/">MySQL</a>, <a class="has-link-grey -link" href="/tags/数据库/">数据库</a>, <a class="has-link-grey -link" href="/tags/集群/">集群</a>
                </div>
            </div>
        </div>
        
        
        
            <p style="padding-bottom: 1rem">
            <span id="busuanzi_container_page_pv">
               本文总阅读量<span id="busuanzi_value_page_pv"></span>次
            </span>
            </p>
        
        
            <div class="social-share"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css">
<script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script>
            <!-- <div class="share-component" data-disabled="google, twitter, facebook, tencent, douban, linkedin"></div> -->
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3>
        <div class="buttons is-centered">
            
                
<a class="button is-success donate">
    <span class="icon is-small">
        <i class="fab fa-weixin"></i>
    </span>
    <span>微信</span>
    <div class="qrcode"><img src="/images/wxpay.jpg" alt="微信"></div>
</a>

                
                
<a class="button is-info donate">
    <span class="icon is-small">
        <i class="fab fa-alipay"></i>
    </span>
    <span>支付宝</span>
    <div class="qrcode"><img src="/images/alipay.jpg" alt="支付宝"></div>
</a>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2015/10/06/4596d72ad01f47bf.html">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">C/C++结构体的内存对齐</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2015/10/02/7607fe3b0f8b4815.html">
                <span class="level-item">使用VSFTP搭建FTP服务器</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<script>
    var disqus_config = function () {
        this.page.url = 'https://i36.Me/2015/10/03/63b2f7bb5a474de48.html';
        this.page.identifier = '63b2f7bb5a474de48';
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'i36me' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </div>
</div>

</div>
                 
                    




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left is-sticky">
    
    
        <div class="column-right-shadow  ">
            
                
<!-- <div class="card widget" id="toc" style="max-height: 500px; overflow: auto;"> -->
<div class="card widget" id="toc" style="overflow: auto;">
    <div class="card-content">
        <div class="menu" style="max-height: 500px; overflow: auto;">
            <h3 class="menu-label">
                目录
            </h3>
            <ul class="menu-list"><li>
        <a href="#环境信息">
        <span class="has-mr-6">1</span>
        <span>环境信息</span>
        </a></li><li>
        <a href="#安装过程">
        <span class="has-mr-6">2</span>
        <span>安装过程</span>
        </a></li><li>
        <a href="#节点克隆">
        <span class="has-mr-6">3</span>
        <span>节点克隆</span>
        </a></li><li>
        <a href="#结点配置">
        <span class="has-mr-6">4</span>
        <span>结点配置</span>
        </a>&nbsp&nbsp<i class="fa fa-chevron-down"></i>
            <i class="fa fa-chevron-right"></i><ul class="menu-list"><li>
        <a href="#管理节点-MGM-配置">
        <span class="has-mr-6">4.1</span>
        <span>管理节点(MGM)配置</span>
        </a></li><li>
        <a href="#数据节点-NDB-配置">
        <span class="has-mr-6">4.2</span>
        <span>数据节点(NDB)配置</span>
        </a></li><li>
        <a href="#SQL节点-API-配置">
        <span class="has-mr-6">4.3</span>
        <span>SQL节点(API)配置</span>
        </a></li><li>
        <a href="#集群状态检查">
        <span class="has-mr-6">4.4</span>
        <span>集群状态检查</span>
        </a></li><li>
        <a href="#参考文档">
        <span class="has-mr-6">4.5</span>
        <span>参考文档</span>
        </a></li></ul></li><li>
        <a href="#集群测试">
        <span class="has-mr-6">5</span>
        <span>集群测试</span>
        </a>&nbsp&nbsp<i class="fa fa-chevron-down"></i>
            <i class="fa fa-chevron-right"></i><ul class="menu-list"><li>
        <a href="#执行测试">
        <span class="has-mr-6">5.1</span>
        <span>执行测试</span>
        </a></li><li>
        <a href="#参考文档-1">
        <span class="has-mr-6">5.2</span>
        <span>参考文档</span>
        </a></li></ul></li></ul>
        </div>
    </div>
</div>

            
                
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/03/01/b7863297bbd9f2f618.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/i/gwfcUk9i2GF57tW.png" alt="MySQL与Postgres的比较">
                </p>
            </a> 
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-28T16:00:00.000Z">2019-03-01</time></div>
                    <a href="/2019/03/01/b7863297bbd9f2f618.html" class="has-link-black-ter is-size-6">MySQL与Postgres的比较</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/MySQL/">MySQL</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2016/07/01/d6e189234c794124.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/i/SzQ6SyZq9pQSSBm.jpg" alt="全民夺宝重构细节：幸运码的生成">
                </p>
            </a> 
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2016-06-30T16:00:00.000Z">2016-07-01</time></div>
                    <a href="/2016/07/01/d6e189234c794124.html" class="has-link-black-ter is-size-6">全民夺宝重构细节：幸运码的生成</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Java/">Java</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2016/01/12/7ee4c380575e4507a.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/i/5IjsBmMdWfvpNSG.png" alt="使用Nginx/uWSGI部署Django项目">
                </p>
            </a> 
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2016-01-11T16:00:00.000Z">2016-01-12</time></div>
                    <a href="/2016/01/12/7ee4c380575e4507a.html" class="has-link-black-ter is-size-6">使用Nginx/uWSGI部署Django项目</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Python/">Python</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2015/12/26/674d696d60c44ee7b.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/i/TdWDkbOpXxMQBtf.jpg" alt="基于UTL_TCP实现FTP传输文件">
                </p>
            </a> 
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2015-12-25T16:00:00.000Z">2015-12-26</time></div>
                    <a href="/2015/12/26/674d696d60c44ee7b.html" class="has-link-black-ter is-size-6">基于UTL_TCP实现FTP传输文件</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Oracle/">Oracle</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2015/12/21/254796bcaedf4dfc9.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/i/meP7GEgIAihkZT3.jpg" alt="快速开发美观的HTML报表">
                </p>
            </a> 
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2015-12-20T16:00:00.000Z">2015-12-21</time></div>
                    <a href="/2015/12/21/254796bcaedf4dfc9.html" class="has-link-black-ter is-size-6">快速开发美观的HTML报表</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Oracle/">Oracle</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

            
                <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">七月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/01/">
                <span class="level-start">
                    <span class="level-item">一月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2015/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2015</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2015/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2015</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2015/10/">
                <span class="level-start">
                    <span class="level-item">十月 2015</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
            
                <!-- <div class="card widget">
    
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <ul class="menu-list">
                
                <li>
                    <a class="level is-marginless" href="/tags/C/">
                        <span class="level-start">
                            <span class="level-item">C</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/C/">
                        <span class="level-start">
                            <span class="level-item">C++</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Django/">
                        <span class="level-start">
                            <span class="level-item">Django</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/EBS/">
                        <span class="level-start">
                            <span class="level-item">EBS</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">6</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/FTP/">
                        <span class="level-start">
                            <span class="level-item">FTP</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/GNome/">
                        <span class="level-start">
                            <span class="level-item">GNome</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Hexo/">
                        <span class="level-start">
                            <span class="level-item">Hexo</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Java/">
                        <span class="level-start">
                            <span class="level-item">Java</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Linux/">
                        <span class="level-start">
                            <span class="level-item">Linux</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">5</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/MySQL/">
                        <span class="level-start">
                            <span class="level-item">MySQL</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Oracle/">
                        <span class="level-start">
                            <span class="level-item">Oracle</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">7</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/PLSQL/">
                        <span class="level-start">
                            <span class="level-item">PLSQL</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Postgres/">
                        <span class="level-start">
                            <span class="level-item">Postgres</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Python/">
                        <span class="level-start">
                            <span class="level-item">Python</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/RSA/">
                        <span class="level-start">
                            <span class="level-item">RSA</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/SSH/">
                        <span class="level-start">
                            <span class="level-item">SSH</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/SSL/">
                        <span class="level-start">
                            <span class="level-item">SSL</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/Ubuntu/">
                        <span class="level-start">
                            <span class="level-item">Ubuntu</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/全民夺宝/">
                        <span class="level-start">
                            <span class="level-item">全民夺宝</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/内存/">
                        <span class="level-start">
                            <span class="level-item">内存</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/内存对齐/">
                        <span class="level-start">
                            <span class="level-item">内存对齐</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/博客/">
                        <span class="level-start">
                            <span class="level-item">博客</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/数据库/">
                        <span class="level-start">
                            <span class="level-item">数据库</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">2</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/源/">
                        <span class="level-start">
                            <span class="level-item">源</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/生活/">
                        <span class="level-start">
                            <span class="level-item">生活</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/白云山/">
                        <span class="level-start">
                            <span class="level-item">白云山</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/随机/">
                        <span class="level-start">
                            <span class="level-item">随机</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/集群/">
                        <span class="level-start">
                            <span class="level-item">集群</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div> -->
            
        </div>
    
</div>


                
            </div>
        </div>
    </section>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="MySQL集群实验" height="28">
                
                </a>
                <p class="is-size-7" style="padding-bottom: 0.5em">
                    <!-- <span id="busuanzi_container_site_pv">
                        本站总访问量<span id="busuanzi_value_site_pv"></span>次
                    </span>
                    <span id="busuanzi_container_site_uv">
                      &nbsp;&nbsp;&nbsp;本站访客数<span id="busuanzi_value_site_uv"></span>人次
                    </span>
                    -->
                    <span id="timeDate" class="is-size-7">&nbsp;&nbsp;&nbsp;载入天数...</span>
                    <span id="times" class="is-size-7">&nbsp;&nbsp;&nbsp;载入时分秒...</span>
                </p>
                <p class="is-size-7">
                &copy; 2020 阿北&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-icarus">Icarus</a>
                </p>
                <script>
                    var now = new Date(); 
                    function createtime() { 
                        var grt = new Date("10/01/2015 16:49:00");//此处修改你的建站时间或者网站上线时间 
                        now.setTime(now.getTime()+250); 
                        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                        document.getElementById("timeDate").innerHTML = "&nbsp;&nbsp;&nbsp;"+"本站已安全运行 "+dnum+" 天 "; 
                        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
                    } 
                setInterval("createtime()",250);
                </script>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
</body>
</html>
